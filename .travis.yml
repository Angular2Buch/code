language: node_js

node_js:
  - '0.12'

before_install:
- npm install -g jspm@beta
- jspm config registries.github.auth $JSPM_GITHUB_AUTH_TOKEN
- jspm install

install:
- npm install
- cd e2e
- npm install

# see http://docs.travis-ci.com/user/gui-and-headless-browsers/
before_script:
- export DISPLAY=:99.0
- sh -e /etc/init.d/xvfb start
- 'node_modules/protractor/bin/webdriver-manager start 2>&1 &'
- sleep 3

script:
- cd $TRAVIS_BUILD_DIR
- npm run-script deploy # for now we always deploy first (subject to change?)
- sleep 300 # some waiting time to be sure that gh-pages is fine
- cd e2e
- npm test # integration tests

# using Sauce Labs
addons:
  sauce_connect: true

env:
  global:
    secure: VXtAaCHOms4nz2UlM+K/J/TZlzZ/Svpnd7iDRD2i0rdKc2b5vXTLMJ1Q4IuS4kA+V0P5qkV0/1vaH+WrjPDTsGTR+kmgu3hxw4/CP3r5Pnu+4nJhPp98NDWTsaekaxqKmvhRhPoeSsdCoklbB+9MH2oCaGQXMAVTlOk+mL9q//+DBJcYfIZDHeHhtixat14PonNvdjudLWhbhHOg1ZKsSacYMnfEzL7KgErIp6zNOKM5eXUgfY9K0Q/6ygcTp9voKJi0G1honaQ8F6qWoCbZSqaoTp06I26Y6i7pz2DUQ3mKdCwDpns/zIwW4LnLXnLOP9doL7jb1CGdqs4dPD+x5Yqh7jRsy2MTR75PGaLt0eTmN09S/54nzEAlfBh+bw2BknFAwp4ZAJts24P5HMQlWZttwwtJo9JHYXJoMFKIgi38UzLZ52qKuEDx27r7Xn6WzG7aKWIgbPUulUZVgeHG0dYJBDEz3G8acvYx5w6o+b4WQS2DrD2nNogoKQV0SEwcex9YdpwrO3KTubOcYnHtqx0/E6eKKsARFTuzBcvqUzjs2j14/nKl33FlNd88INEAQR0EQFacfBadBwwuUZt5OZE4z5pUMnau7hXikr8+sGb4z2zGRcy695kO1Q5W+MZ81gHZZdrqR9B8J9szH0keV0Sh0ZNRlOWMgOERTTpg68s=
